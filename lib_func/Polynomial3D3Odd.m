function out = Polynomial3D3Odd(X)
    N = numel(X)/3;
    X = reshape(X,N,3);
    out = zeros(N,20,3,3);

    % 2nd order terms
    out(:,5,1,1) = 2;
    out(:,6,2,1) = 1;
    out(:,7,3,1) = 1;
    out(:,6,1,2) = 1;
    out(:,8,2,2) = 2;
    out(:,9,3,2) = 1;
    out(:,7,1,3) = 1;
    out(:,9,2,3) = 1;
    out(:,10,3,3) = 2;

    % 3rd order terms
    out(:,11,1,1) = 6*X(:,1);
    out(:,12,1,1) = 2*X(:,2);
    out(:,12,1,2) = 2*X(:,1);
    out(:,12,2,1) = 2*X(:,1);
    out(:,13,1,1) = 2*X(:,3);
    out(:,13,1,3) = 2*X(:,1);
    out(:,13,3,1) = 2*X(:,1);
    out(:,14,2,2) = 2*X(:,1);
    out(:,14,1,2) = 2*X(:,2);
    out(:,14,2,1) = 2*X(:,2);   
    out(:,15,1,2) = X(:,3);
    out(:,15,2,1) = X(:,3);
    out(:,15,1,3) = X(:,2);   
    out(:,15,3,1) = X(:,2);
    out(:,15,2,3) = X(:,1);   
    out(:,15,3,2) = X(:,1);
    out(:,16,3,3) = 2*X(:,1);
    out(:,16,1,3) = 2*X(:,3);
    out(:,16,3,1) = 2*X(:,3);     
    out(:,17,2,2) = 6*X(:,2);
    out(:,18,2,2) = 2*X(:,3);
    out(:,18,2,3) = 2*X(:,2);   
    out(:,18,3,2) = 2*X(:,2); 
    out(:,19,3,3) = 2*X(:,2);
    out(:,19,2,3) = 2*X(:,3);   
    out(:,19,3,2) = 2*X(:,3);    
    out(:,20,3,3) = 6*X(:,3);
end